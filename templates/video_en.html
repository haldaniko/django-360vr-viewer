{% load static %}

{% load static %}
<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8"/>
  <title>Inner World</title>
  <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
  <link rel="stylesheet" href="{% static 'css/video360.css' %}">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="header__container">
    <div class="header__info">
      <img class="header__erasmus" alt="EU" src="{% static 'img/Erasmus.jpg' %}">
      <img class="header__logo" alt="logo" src="{% static 'img/inner_world_logo.png' %}">
      <h1 class="header__title">Virtual Reality Platform<br> for Psychosocial Support</h1>
    </div>
    <nav class="header__lang">
      <ul class="header__lang-list">
        <li class="header__lang-item"><a href="?lang=tr" class="header__lang-link">TR</a></li>
        <li class="header__lang-item"><a href="?lang=en" class="header__lang-link--active">EN</a></li>
        <li class="header__lang-item"><a href="?lang=fr" class="header__lang-link">FR</a></li>
        <li class="header__lang-item"><a href="?lang=ua" class="header__lang-link">UA</a></li>
        <li class="header__lang-item"><a href="?lang=bg" class="header__lang-link">BG</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- Main Content -->
<main>
  <!-- About -->
  <section class="about">
    <h2 class="about__title">About</h2>
    <p class="about__description">
      Virtual Reality for Psychosocial Support is a KA210 project created within the framework of the
      Erasmus+ programme, dedicated to transforming the way mental health support is delivered to displaced youth. The
      project has a focus on youth affected by the war in Ukraine. Through innovative use of virtual reality (VR)
      technology, the project aims to build a safe, engaging, and barrier-free environment for psychosocial support that
      responds to the diverse needs of people aged 13â€“20.<br><br>

      Over 18 months, our international team from Bulgaria, France, and TÃ¼rkiye created, tested, and shared a VR tool
      designed to enhance the quality and accessibility of mental health assistance. Sixty displaced young people took
      part in the pilot phase, receiving personalised, high-quality VR-based support, while six trained mental health
      professionals learned to integrate this tool into their practice. InnerWorldâ€™s approach removes common barriers
      such as language, cost, and geography, enabling more young people to
      access help when and where they need it. The project also invested in long-term impact, ensuring the VR method can
      be adopted widely in Europe and beyond. By combining digital innovation, mental health expertise, and
      international collaboration, InnerWorld promotes
      inclusion, supports recovery, and empowers young people to build skills for learning, work, and community life in
      their new environments.
    </p>
  </section>

  <!-- Partners -->
  <section class="partners">
    <div class="partners__container">
      <h2 class="partners__title">Partner Organizations</h2>
      <div class="partners__list">
        <div class="partners__card">
          <a target="_blank" href="https://opendoors.center/">

            <img src="{% static 'img/partner_OpenDoors.jpg' %}" alt="Ortak Logo" class="partners__image"/>
            <h1 class="partners__header">Situational Center Open Doors</h1>
            <p class="partners__description">
              Our mission is to help the people displaced by the war in Ukraine find security and stability in host
              societies in a way that promotes their independence, self-sufficiency, and active civic participation.
            </p>

          </a>
        </div>
        <div class="partners__card">
          <a target="_blank" href="https://ankarabilim.edu.tr/en/index">

            <img src="{% static 'img/partner_AnkaraScienceUniversity.jpg' %}" alt="Ortak Logo" class="partners__image"/>
            <h1 class="partners__header">Ankara Science University</h1>
            <p class="partners__description">
              Ankara Bilim University is a foundation university established 21 April 2016 by the Turkish Efficiency
              Foundation, which aims to develop the awareness and culture extending "sustainable development" at the
              individual and institutional level.
            </p>
          </a>
        </div>
        <div class="partners__card">
          <a target="_blank" href="https://www.instagram.com/ukrrcenter/">

            <img src="{% static 'img/partner_CentreDeRessourcesUkrainen.png' %}" alt="Ortak Logo"
                 class="partners__image"/>
            <h1 class="partners__header">Centre de ressources ukrainen</h1>
            <p class="partners__description">
              Established in October 2022, the CRU acted initially as an informal group, until it gained official status
              in September 2023. CRU's mission is to support Ukrainian displaced people through comprehensive programs
              and
              community initiatives, to bridge barriers and facilitate adaptation.
            </p>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Video -->
  <section class="video">
    <div class="video__container">

      <!-- Thumbnails (centered above the player) -->
      <div class="video__thumbnails">
        <button class="video__thumbnail video__thumbnail--active"
                aria-label="Video 1">
          <img src="{% static 'img/cinema.png' %}" alt="Video 1">
          <span class="video__label">Waterfall</span>
        </button>
        <button class="video__thumbnail" aria-label="Video 2">
          <img src="{% static 'img/grounding.png' %}" alt="Video 2">
          <span class="video__label">Grounding</span>
        </button>
        <button class="video__thumbnail" aria-label="Video 3">
          <img src="{% static 'img/scan.png' %}" alt="Video 3">
          <span class="video__label">Cinema</span>
        </button>
        <button class="video__thumbnail" aria-label="Video 4">
          <img src="{% static 'img/triangle.png' %}" alt="Video 4">
          <span class="video__label">Scanning</span>
        </button>
        <button class="video__thumbnail" aria-label="Video 5">
          <img src="{% static 'img/waterfall.png' %}" alt="Video 5">
          <span class="video__label">Triangle Breath</span>
        </button>
      </div>


      <!-- Player -->
      <div class="video__player-wrapper">
        <video
            id="video360"
            class="video__element"
            playsinline
            crossorigin="anonymous"
            webkit-playsinline
            muted
        ></video>

        <a-scene vr-mode-ui="enabled: true" embedded class="video__scene">
          <a-videosphere
              id="videosphere"
              src="#video360"
              rotation="0 -90 0"
              visible="false"
          ></a-videosphere>
          <a-camera
              look-controls="pointerLockEnabled: true"
              wasd-controls-enabled="false"
          ></a-camera>
        </a-scene>

        <div class="video__play-button" id="playButton" aria-label="Play"></div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer__container">
      <div class="footer__column">
        <h3 class="footer__title">FSCOD contacts</h3>
        <p class="footer__text">Email: contact@opendoors.center</p>
        <p class="footer__text">Phone: +359 884 013 786</p>
        <p class="footer__text">Website:
          <a class="footer__link" target="_blank" href="https://opendoors.center/">
            opendoors.center
          </a>
        </p>

      </div>
      <div class="footer__column">
        <h3 class="footer__title">ABU contacts</h3>
        <p class="footer__text">Email: info@ankarabilim.edu.tr</p>
        <p class="footer__text">Phone: +90 552 899 84 11</p>
        <p class="footer__text">Website:
          <a class="footer__link" target="_blank" href="https://ankarabilim.edu.tr/en/index">
            ankarabilim.edu.tr
          </a>
        </p>

      </div>
      <div class="footer__column">
        <h3 class="footer__title">URC contacts</h3>
        <p class="footer__text">Email: olena.vyshnev@gmail.com</p>
        <p class="footer__text">Phone: +33 065 245 56 39</p>
        <p class="footer__text">Instagram:
          <a class="footer__link" target="_blank" href="https://www.instagram.com/ukrrcenter/">
            @ukrrcenter
          </a>
        </p>

      </div>
      <div class="footer__column">
        <h3 class="footer__title">Guides & Docs</h3>
        <p class="footer__text">
          <a href="{% static 'docs/VR videos guide for direct users.pdf' %}" target="_blank">
            ðŸ“„ Guide for direct users.pdf
          </a>
        </p>
        <p class="footer__text">
          <a href="{% static 'docs/VR videos guide for professionals.pdf' %}" target="_blank">
            ðŸ“„ Guide for professionals.pdf
          </a>
        </p>
        <p class="footer__text">
          <a href="{% static 'docs/Who-5English.pdf' %}" target="_blank">
            ðŸ“„ Who-5English.pdf
          </a>
        </p>
      </div>
      <div class="footer__column">
        <h3 class="footer__title">Regulations</h3>
        <p class="footer__text">
          <a href="{% static 'docs/Privacy Policy.pdf' %}" target="_blank">
            ðŸ“„ Privacy Policy.pdf
          </a>
        </p>
        <p class="footer__text">
          <a href="{% static 'docs/Terms of Use.pdf' %}" target="_blank">
            ðŸ“„ Terms of Use.pdf
          </a>
        </p>
        <p class="footer__text">
          <a href="{% static 'docs/Incident Report template.docx' %}" target="_blank">
            ðŸ“„ Incident Report template.docx
          </a>
        </p>
      </div>
    </div>
    <div class="footer__bottom">
      <hr class="footer__divider">
      <p class="footer__copy">
        InnerWorld: Virtual Reality for Psychosocial Support<br>
        2023-3-TR01-KA210-YOU-000181712<br>
        Â© 2025 All rights reserved.
      </p>
    </div>
  </footer>

</main>

<script>
    const video = document.getElementById('video360');
    const playButton = document.getElementById('playButton');
    const videosphere = document.getElementById('videosphere');

    let player = dashjs.MediaPlayer().create();
    player.updateSettings({
        streaming: {
            buffer: {
                stableBufferTime: 3,
                bufferTimeAtTopQuality: 5,
                bufferTimeAtTopQualityLongForm: 8,
                fastSwitchEnabled: true
            }
        }
    });

    let currentUrl = "{{ cinema_dash_manifest_url }}";
    player.initialize(video, currentUrl, false);

    player.on(dashjs.MediaPlayer.events.ERROR, (e) => {
        console.error('Dash.js error:', e);
        if (e.error && e.error.code === 'QuotaExceededError') {
            player.reset();
            player.initialize(video, currentUrl, false);
            video.pause();
            if (videosphere) videosphere.setAttribute('visible', 'false');
            playButton.style.display = '';
        }
    });

    video.addEventListener('loadeddata', () => {
        if (videosphere) videosphere.setAttribute('visible', 'true');
    });

    playButton.addEventListener('click', () => {
        player.play();
        video.muted = false;
        video.play().catch(e => console.error('Video play failed:', e));
        playButton.style.display = 'none';
    });

    const urlMap = {
        0: "{{ cinema_dash_manifest_url }}",
        1: "{{ grounding_dash_manifest_url }}",
        2: "{{ scan_dash_manifest_url }}",
        3: "{{ triangle_dash_manifest_url }}",
        4: "{{ waterfall_dash_manifest_url }}"
    };

    const thumbnails = document.querySelectorAll('.video__thumbnail');
    thumbnails.forEach((thumb, index) => {
        thumb.addEventListener('click', () => {
            thumbnails.forEach(t => t.classList.remove('video__thumbnail--active'));
            thumb.classList.add('video__thumbnail--active');

            const url = urlMap[index];
            currentUrl = url;

            player.reset();
            player.initialize(video, url, false);
            video.muted = false;

            if (videosphere) videosphere.setAttribute('visible', 'true');

            playButton.style.display = '';
        });
    });
</script>


</body>
</html>